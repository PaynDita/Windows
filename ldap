
 Anonymous Bind (if allowed):
ldapsearch -x -H ldap://10.0.0.5 -b "dc=corp,dc=local"

----------------------------------------------------------------------

If anonymous bind is disabled (default in newer domains), use low-priv creds:

ldapsearch -x -H ldap://10.0.0.5 -D "corp\\lowprivuser" -w password -b "dc=corp,dc=local"


--------------------------------------------------------------------------

ğŸ”¥ Real-World Example Flow

ğŸ” Use ldapsearch to dump all users:

ldapsearch -x -H ldap://10.0.0.5 -b "dc=corp,dc=local" "(objectClass=user)" sAMAccountName

-----------------------------------------------------------------------------------------------








LDAP enumeration is the process of querying an Active Directory (AD) server (usually a Domain Controller) over LDAP (Lightweight Directory Access Protocol) to gather information such as:

Valid usernames

Groups and memberships

Password policies

SPNs (Service Principal Names)

Email addresses

Computer names

Organizational Units (OUs)

âš ï¸ Often possible without authentication if LDAP is misconfigured (anonymous bind), or with low-privilege creds.

ğŸ“š Why Use LDAP Enumeration?

It gives attackers a goldmine of data to:

Build a list of valid users

Find high-value targets (e.g., svc_accounts, Domain Admins)

Identify accounts vulnerable to AS-REP Roasting or Kerberoasting

Map the AD structure (OUs, trust relationships)

âš”ï¸ Example: LDAP Enumeration using ldapsearch

Letâ€™s say the target domain is corp.local, and the DC is at 10.0.0.5.

âœ… Anonymous Bind (if allowed):
ldapsearch -x -H ldap://10.0.0.5 -b "dc=corp,dc=local"


This tries to connect without any credentials and lists directory info.

If it works, youâ€™ll see entries like:

dn: CN=John Smith,CN=Users,DC=corp,DC=local
sAMAccountName: jsmith
userPrincipalName: jsmith@corp.local

ğŸ” Authenticated Bind:

If anonymous bind is disabled (default in newer domains), use low-priv creds:

ldapsearch -x -H ldap://10.0.0.5 -D "corp\\lowprivuser" -w password -b "dc=corp,dc=local"

ğŸ’¡ What You Can Enumerate via LDAP
Info Type	LDAP Attribute
Usernames	sAMAccountName
Display Name	displayName
Email	mail
Group Memberships	memberOf
Description (often contains passwords ğŸ˜¬)	description
SPNs	servicePrincipalName
Last logon	lastLogonTimestamp
Password policy	Domain attributes
ğŸ†š How LDAP Enum Differs from Kerbrute
Feature	LDAP Enumeration	Kerbrute
Protocol	LDAP	Kerberos
Can find SPNs?	âœ… Yes	âŒ No
Can find usernames?	âœ… Yes	âœ… Yes (via Kerberos error messages)
Requires creds?	âŒ Sometimes (anon bind works)	âŒ (for enum / AS-REP)
Can brute-force creds?	âŒ No	âœ… Yes (password spray)
Stealth level	ğŸ”¸ Moderate	âœ… High (no LDAP logs)
ğŸ”¥ Real-World Example Flow

ğŸ” Use ldapsearch to dump all users:

ldapsearch -x -H ldap://10.0.0.5 -b "dc=corp,dc=local" "(objectClass=user)" sAMAccountName


ğŸ“„ Save results to users.txt.

ğŸ¯ Use with GetNPUsers.py or kerbrute to check for AS-REP roasting:

python3 GetNPUsers.py corp.local/ -usersfile users.txt -dc-ip 10.0.0.5 -no-pass

ğŸ›¡ï¸ Defender Tip

To harden LDAP:

Disable anonymous binds.

Restrict LDAP access via firewalls.

Enable LDAP signing.

Use LDAPS (encrypted).

Monitor for excessive enumeration.
